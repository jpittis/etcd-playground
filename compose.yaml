version: '3'

services:
  etcd1:
    build:
      context: .
      dockerfile: etcd/Dockerfile
    command: /etcd/bin/runner /etcd/bin/etcd etcd1 /etc/runner.yml
    volumes:
      - "./config/runner.yml:/etc/runner.yml"
    ports:
      - "2379:2379"
    cap_add:
      - NET_ADMIN

  etcd2:
    build:
      context: .
      dockerfile: etcd/Dockerfile
    command: /etcd/bin/runner /etcd/bin/etcd etcd2 /etc/runner.yml
    volumes:
      - "./config/runner.yml:/etc/runner.yml"
    ports:
      - "3379:2379"
    cap_add:
      - NET_ADMIN

  etcd3:
    build:
      context: .
      dockerfile: etcd/Dockerfile
    command: /etcd/bin/runner /etcd/bin/etcd etcd3 /etc/runner.yml
    volumes:
      - "./config/runner.yml:/etc/runner.yml"
    ports:
      - "4379:2379"
    cap_add:
      - NET_ADMIN

  prometheus:
    image: prom/prometheus
    volumes:
      - "./config/prometheus.yml:/etc/prometheus/prometheus.yml"
    ports:
      - 9090:9090
